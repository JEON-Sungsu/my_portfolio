# Monki ëŒ€ê¸°ê´€ë¦¬ CEO ì•± - í¬íŠ¸í´ë¦¬ì˜¤ ë¬¸ì„œ

## ğŸ“‹ í”„ë¡œì íŠ¸ ê°œìš”

**í”„ë¡œì íŠ¸ëª…**: Monki Waiting CEO App
**í”Œë«í¼**: Flutter (Android/iOS)
**ë²„ì „**: 1.0.7+1
**í”„ë¡œì íŠ¸ ê¸°ê°„**: 2024 ~ 2025
**ëª©ì **: ë ˆìŠ¤í† ë‘/ë§¤ì¥ CEOë¥¼ ìœ„í•œ ì‹¤ì‹œê°„ ëŒ€ê¸°ê³ ê° ê´€ë¦¬ íƒœë¸”ë¦¿/ëª¨ë°”ì¼ ì•±

### í•µì‹¬ ê°€ì¹˜

- ì‹¤ì‹œê°„ ëŒ€ê¸°ê³ ê° í˜„í™© ëª¨ë‹ˆí„°ë§ ë° ê´€ë¦¬
- MQTT ê¸°ë°˜ ì‹¤ì‹œê°„ ì•Œë¦¼ ì‹œìŠ¤í…œ
- íƒœë¸”ë¦¿/ëª¨ë°”ì¼ ë°˜ì‘í˜• UI
- OTA(Over-The-Air) ë¬´ì„  ì•± ì—…ë°ì´íŠ¸
- Clean Architecture ê¸°ë°˜ í™•ì¥ ê°€ëŠ¥í•œ êµ¬ì¡°

---

## ğŸ›  ê¸°ìˆ  ìŠ¤íƒ

### Frontend Framework

- **Flutter 3.6.0+**: í¬ë¡œìŠ¤ í”Œë«í¼ ëª¨ë°”ì¼ ì•± í”„ë ˆì„ì›Œí¬
- **Dart**: ì• í”Œë¦¬ì¼€ì´ì…˜ ê°œë°œ ì–¸ì–´

### ìƒíƒœ ê´€ë¦¬ & ì•„í‚¤í…ì²˜

- **Flutter Riverpod 2.6.1**: ì„ ì–¸ì  ìƒíƒœ ê´€ë¦¬
- **Clean Architecture**: Domain-Data-Presentation ë ˆì´ì–´ ë¶„ë¦¬
- **MVVM íŒ¨í„´**: ViewModel ê¸°ë°˜ UI ë¡œì§ ë¶„ë¦¬

### ë„¤íŠ¸ì›Œí‚¹ & API

- **Dio 5.7.0**: HTTP í´ë¼ì´ì–¸íŠ¸
- **Retrofit 4.4.2**: íƒ€ì… ì•ˆì „ REST API í´ë¼ì´ì–¸íŠ¸
- **Pretty Dio Logger**: API í†µì‹  ë””ë²„ê¹…

### ì‹¤ì‹œê°„ í†µì‹ 

- **MQTT Client 10.0.0**: ì‹¤ì‹œê°„ ì–‘ë°©í–¥ ë©”ì‹œì§• í”„ë¡œí† ì½œ
  - ëŒ€ê¸°ê³ ê° ë“±ë¡/ì·¨ì†Œ ì‹¤ì‹œê°„ ì•Œë¦¼
  - ê³ ê° ìƒíƒœ ë³€ê²½ ë™ê¸°í™”

### ë¡œì»¬ ë°ì´í„°ë² ì´ìŠ¤

- **Hive 2.2.3**: NoSQL ë¡œì»¬ ë°ì´í„°ë² ì´ìŠ¤
- **Path Provider**: íŒŒì¼ ì‹œìŠ¤í…œ ì ‘ê·¼

### ì½”ë“œ ìƒì„± & ì§ë ¬í™”

- **Freezed 2.5.8**: ë¶ˆë³€ ëª¨ë¸ í´ë˜ìŠ¤ ìƒì„±
- **JSON Serializable 6.9.2**: JSON ì§ë ¬í™”/ì—­ì§ë ¬í™”
- **Build Runner**: ì½”ë“œ ìƒì„± ë„êµ¬

### Native í”Œë«í¼ í†µí•©

- **Method Channel**: Flutter-Native ë¸Œë¦¿ì§€
- **Android (Kotlin)**: ë””ë°”ì´ìŠ¤ ì •ë³´ ì¡°íšŒ
- **iOS (Swift)**: ë„¤ì´í‹°ë¸Œ ê¸°ëŠ¥ ì—°ë™

### UI/UX

- **Flutter ScreenUtil 5.9.3**: ë°˜ì‘í˜• í™”ë©´ í¬ê¸° ê´€ë¦¬
- **Flutter SVG 2.0.16**: ë²¡í„° ê·¸ë˜í”½ ë Œë”ë§
- **Go Router 14.6.3**: ì„ ì–¸ì  ë¼ìš°íŒ…
- **Pretendard í°íŠ¸**: í•œê¸€ ìµœì í™” ì»¤ìŠ¤í…€ í°íŠ¸

### ì•± ì—…ë°ì´íŠ¸ & ë””ë°”ì´ìŠ¤ ê´€ë¦¬

- **OTA Update 6.0.0**: ë¬´ì„  ì•± ì—…ë°ì´íŠ¸
- **Package Info Plus 8.3.0**: ì•± ë²„ì „ ì •ë³´ ì¡°íšŒ
- **App Settings 5.2.0**: ì‹œìŠ¤í…œ ì„¤ì • ì ‘ê·¼
- **Flutter UDID**: ë””ë°”ì´ìŠ¤ ê³ ìœ  ì‹ë³„ì
- **Wakelock Plus 1.2.10**: í™”ë©´ êº¼ì§ ë°©ì§€

### DI (ì˜ì¡´ì„± ì£¼ì…)

- **GetIt 8.0.3**: ì„œë¹„ìŠ¤ ë¡œì¼€ì´í„° íŒ¨í„´

### ìœ í‹¸ë¦¬í‹°

- **Logger 2.5.0**: êµ¬ì¡°í™”ëœ ë¡œê¹…
- **Intl 0.20.1**: êµ­ì œí™” ë° ë‚ ì§œ/ì‹œê°„ í¬ë§·
- **Crypto 3.0.6**: ì•”í˜¸í™” ê¸°ëŠ¥

---

## ğŸ— ì•„í‚¤í…ì²˜ ì„¤ê³„

### Clean Architecture ë ˆì´ì–´ êµ¬ì¡°

```
lib/
â”œâ”€â”€ domain/                 # ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ë ˆì´ì–´
â”‚   â”œâ”€â”€ model/             # ë„ë©”ì¸ ëª¨ë¸
â”‚   â””â”€â”€ use_cases/         # ë¹„ì¦ˆë‹ˆìŠ¤ ìœ ìŠ¤ì¼€ì´ìŠ¤
â”‚       â”œâ”€â”€ auth/          # ì¸ì¦ ê´€ë ¨
â”‚       â”œâ”€â”€ waiting_guest/ # ëŒ€ê¸°ê³ ê° ê´€ë¦¬
â”‚       â”œâ”€â”€ waiting_setting/ # ëŒ€ê¸° ì„¤ì •
â”‚       â”œâ”€â”€ my/            # ë§ˆì´í˜ì´ì§€
â”‚       â”œâ”€â”€ initial/       # ì´ˆê¸° ë°ì´í„°
â”‚       â””â”€â”€ app_version/   # ì•± ë²„ì „ ê´€ë¦¬
â”‚
â”œâ”€â”€ data/                   # ë°ì´í„° ë ˆì´ì–´
â”‚   â””â”€â”€ repositories/      # Repository êµ¬í˜„
â”‚       â”œâ”€â”€ auth/
â”‚       â”œâ”€â”€ waiting_guest/
â”‚       â”œâ”€â”€ waiting_setting/
â”‚       â”œâ”€â”€ my/
â”‚       â”œâ”€â”€ initial/
â”‚       â”œâ”€â”€ store/
â”‚       â””â”€â”€ app_version/
â”‚
â”œâ”€â”€ services/               # ì„œë¹„ìŠ¤ ë ˆì´ì–´
â”‚   â”œâ”€â”€ monki_api_service/ # API í†µì‹ 
â”‚   â”‚   â”œâ”€â”€ auth/
â”‚   â”‚   â”œâ”€â”€ waiting_guest/
â”‚   â”‚   â”œâ”€â”€ waiting_setting/
â”‚   â”‚   â”œâ”€â”€ my/
â”‚   â”‚   â”œâ”€â”€ initial/
â”‚   â”‚   â”œâ”€â”€ store/
â”‚   â”‚   â””â”€â”€ app_version/
â”‚   â”œâ”€â”€ monki_mqtt_service/ # MQTT ì‹¤ì‹œê°„ í†µì‹ 
â”‚   â”œâ”€â”€ database_service/   # Hive ë¡œì»¬ DB
â”‚   â”œâ”€â”€ system_service/     # ë„¤ì´í‹°ë¸Œ í”Œë«í¼ ë¸Œë¦¿ì§€
â”‚   â””â”€â”€ app_update_service/ # OTA ì—…ë°ì´íŠ¸
â”‚
â”œâ”€â”€ ui/                     # Presentation ë ˆì´ì–´
â”‚   â”œâ”€â”€ views/             # í™”ë©´ ë‹¨ìœ„
â”‚   â”‚   â”œâ”€â”€ startup/       # ì•± ì‹œì‘ í™”ë©´
â”‚   â”‚   â”œâ”€â”€ sign_in/       # ë¡œê·¸ì¸
â”‚   â”‚   â”œâ”€â”€ main/          # ë©”ì¸ ë„¤ë¹„ê²Œì´ì…˜
â”‚   â”‚   â”œâ”€â”€ waiting_manage/ # ëŒ€ê¸° ê´€ë¦¬ (í•µì‹¬ ê¸°ëŠ¥)
â”‚   â”‚   â”œâ”€â”€ waiting_setting/ # ëŒ€ê¸° ì„¤ì •
â”‚   â”‚   â”œâ”€â”€ my_page/       # ë§ˆì´í˜ì´ì§€
â”‚   â”‚   â””â”€â”€ password_change/ # ë¹„ë°€ë²ˆí˜¸ ë³€ê²½
â”‚   â”œâ”€â”€ routes/            # ë¼ìš°íŒ… ì„¤ì •
â”‚   â””â”€â”€ common/            # ê³µí†µ UI ì»´í¬ë„ŒíŠ¸
â”‚
â”œâ”€â”€ models/                 # ê¸€ë¡œë²Œ ìƒíƒœ ëª¨ë¸
â”‚   â”œâ”€â”€ app_auth.dart      # ì¸ì¦ ìƒíƒœ
â”‚   â”œâ”€â”€ app_waiting_guest.dart # ëŒ€ê¸°ê³ ê° ìƒíƒœ
â”‚   â”œâ”€â”€ app_waiting_setting.dart # ì„¤ì • ìƒíƒœ
â”‚   â”œâ”€â”€ app_loading.dart   # ë¡œë”© ìƒíƒœ
â”‚   â”œâ”€â”€ app_api_error.dart # API ì—ëŸ¬ ìƒíƒœ
â”‚   â””â”€â”€ app_timer.dart     # íƒ€ì´ë¨¸ ìƒíƒœ
â”‚
â”œâ”€â”€ widgets/                # ì¬ì‚¬ìš© ê°€ëŠ¥í•œ ìœ„ì ¯
â”œâ”€â”€ resources/              # ë””ìì¸ ë¦¬ì†ŒìŠ¤ (ìƒ‰ìƒ, í…ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼)
â”œâ”€â”€ utils/                  # ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜
â””â”€â”€ di/                     # ì˜ì¡´ì„± ì£¼ì… ì„¤ì •
```

### ì£¼ìš” ì•„í‚¤í…ì²˜ íŒ¨í„´

#### 1. Repository Pattern

```dart
// Domain Layer - Interface
abstract class WaitingGuestRepository {
  Future<ApiResult> getActiveGuestList({...});
  Future<ApiResult> updateGuestStatus({...});
}

// Data Layer - Implementation
class WaitingGuestRepositoryImpl implements WaitingGuestRepository {
  final WaitingGuestApiService _apiService;

  @override
  Future<ApiResult> getActiveGuestList({...}) async {
    return await _apiService.getActiveGuestList(...);
  }
}
```

#### 2. Use Case Pattern

```dart
class GetActiveGuestListUseCase {
  final WaitingGuestRepository _repository;

  Future<ApiResult> execute({required int listItemCount, int? cursor}) {
    return _repository.getActiveGuestList(
      listItemCount: listItemCount,
      cursor: cursor,
    );
  }
}
```

#### 3. MVVM with Riverpod

```dart
class WaitingManageViewModel extends BaseViewModel {
  final GetActiveGuestListUseCase _getActiveGuestListUseCase;
  final AppWaitingGuest _appWaitingGuest; // Global State

  Future<void> loadActiveGuests() async {
    final result = await _getActiveGuestListUseCase.execute(...);
    if (result is ApiSuccess) {
      _appWaitingGuest.updateActiveGuestData(...);
    }
  }
}
```

#### 4. Service Locator (Dependency Injection)

```dart
// GetItì„ ì‚¬ìš©í•œ ì˜ì¡´ì„± ì£¼ì…
Future<void> configureDependencies() async {
  // API Clients
  serviceLocator.registerSingleton<Dio>(createDio());
  serviceLocator.registerSingleton<WaitingGuestApiClient>(...);

  // Services
  serviceLocator.registerSingleton<WaitingGuestApiService>(...);
  serviceLocator.registerSingleton<MonkiMqttService>(...);

  // Repositories
  serviceLocator.registerSingleton<WaitingGuestRepository>(...);

  // Use Cases
  serviceLocator.registerSingleton<GetActiveGuestListUseCase>(...);

  // Global State Models
  serviceLocator.registerSingleton<AppWaitingGuest>(AppWaitingGuest());
}
```

---

## ğŸ¯ ì£¼ìš” ê¸°ëŠ¥ êµ¬í˜„

### 1. ì‹¤ì‹œê°„ ëŒ€ê¸°ê³ ê° ê´€ë¦¬ ì‹œìŠ¤í…œ

#### í•µì‹¬ ê¸°ëŠ¥

- **ì‹¤ì‹œê°„ ëŒ€ê¸° ëª©ë¡ ì¡°íšŒ**: Pagination ê¸°ë°˜ ë¬´í•œ ìŠ¤í¬ë¡¤
- **ê³ ê° ìƒíƒœ ê´€ë¦¬**: ëŒ€ê¸°ì¤‘ â†’ í˜¸ì¶œ â†’ ì…ì¥ì™„ë£Œ/ëŒ€ê¸°ì·¨ì†Œ
- **ìë™ ì·¨ì†Œ**: ì„¤ì •ëœ ì‹œê°„ ê²½ê³¼ ì‹œ ìë™ ì·¨ì†Œ
- **ì…ì¥ì™„ë£Œ/ì·¨ì†Œ ë‚´ì—­**: ë‚ ì§œë³„ ì¡°íšŒ ë° í•„í„°ë§

#### êµ¬í˜„ ì„¸ë¶€ì‚¬í•­

```dart
// lib/ui/views/waiting_manage/waiting_manage_view_model.dart
class WaitingManageViewModel extends BaseViewModel {
  // Pagination with cursor-based infinite scroll
  Future<void> loadActiveGuests({bool isRefresh = false}) async {
    if (isRefresh) {
      _appWaitingGuest.resetActiveGuestData();
    }

    final cursor = _appWaitingGuest.activeGuestCursor;
    final result = await _getActiveGuestListUseCase.execute(
      listItemCount: listItemCount,
      cursor: cursor,
    );

    if (result is ApiSuccess) {
      final response = result.value as ActiveGuestResponse;
      _appWaitingGuest.updateActiveGuestData(
        activeGuestList: response.waitingGuestList,
        cursor: response.cursor,
        hasActiveListNext: response.hasNext,
      );
    }
  }

  // ê³ ê° ìƒíƒœ ì—…ë°ì´íŠ¸ (í˜¸ì¶œ/ì…ì¥ì™„ë£Œ/ì·¨ì†Œ)
  Future<void> updateGuestStatus({
    required int guestId,
    required GuestStatus status,
  }) async {
    setLoading(true);

    final result = await _updateGuestStatusUseCase.execute(
      guestId: guestId,
      status: status.value,
    );

    if (result is ApiSuccess) {
      await loadActiveGuests(isRefresh: true); // ëª©ë¡ ê°±ì‹ 
    } else {
      _appApiError.setOccurredApiError(
        isOccurredApiError: true,
        errorText: 'ìƒíƒœ ë³€ê²½ ì‹¤íŒ¨',
      );
    }

    setLoading(false);
  }
}
```

#### ê¸°ìˆ ì  ë„ì „ê³¼ í•´ê²°

**ë¬¸ì œ**: ëŒ€ê¸° ëª©ë¡ ìƒˆë¡œê³ ì¹¨ ì‹œ ê¹œë¹¡ì„ í˜„ìƒ
**í•´ê²°**:

- Riverpodì˜ `notifyListeners()` í˜¸ì¶œ ìµœì í™”
- `needNotify` í”Œë˜ê·¸ë¥¼ í†µí•œ ì„ íƒì  UI ì—…ë°ì´íŠ¸

```dart
void updateActiveGuestData({
  required List<Guest> activeGuestList,
  required int? cursor,
  required bool hasActiveListNext,
  bool needNotify = false, // ì„ íƒì  ì•Œë¦¼
}) {
  _activeGuestList.addAll(activeGuestList);
  _activeGuestCursor = cursor;
  _hasActiveListNext = hasActiveListNext;

  if (needNotify) {
    notifyListeners();
  }
}
```

### 2. MQTT ê¸°ë°˜ ì‹¤ì‹œê°„ ì•Œë¦¼ ì‹œìŠ¤í…œ

#### í•µì‹¬ ê¸°ëŠ¥

- **ì‹¤ì‹œê°„ ëŒ€ê¸° ë“±ë¡ ì•Œë¦¼**: ê³ ê°ì´ ì•±ì—ì„œ ëŒ€ê¸° ë“±ë¡ ì‹œ ì¦‰ì‹œ ë°˜ì˜
- **ê³ ê° ì§ì ‘ ì·¨ì†Œ ì•Œë¦¼**: ê³ ê°ì´ ëŒ€ê¸° ì·¨ì†Œ ì‹œ CEO ì•±ì— ì•Œë¦¼
- **ìë™ ì·¨ì†Œ ì•Œë¦¼**: ì‹œê°„ ì´ˆê³¼ë¡œ ìë™ ì·¨ì†Œ ì‹œ ì•Œë¦¼

#### êµ¬í˜„ ì„¸ë¶€ì‚¬í•­

```dart
// lib/services/monki_mqtt_service/mqtt_notification_handler.dart
class MqttNotificationHandler {
  Future<void> handleNotification(NotificationMessage message) async {
    final jsonParams = (message.params is String)
        ? json.decode(message.params as String)
        : message.params as Map<String, Object?>;

    switch (message.notification) {
      case MqttNotificationType.ceoWaitingRegistered:
        await _updateWaitCustomer(params: jsonParams);
        break;

      case MqttNotificationType.ceoWaitingCanceledByUser:
      case MqttNotificationType.ceoWaitingAutoCanceled:
        await _updateCanceledCustomer(params: jsonParams);
        break;
    }
  }

  // ëŒ€ê¸° ë“±ë¡ ì‹œ ì „ì²´ ëª©ë¡ ìƒˆë¡œê³ ì¹¨
  Future<void> _updateWaitCustomer({
    required Map<String, dynamic> params
  }) async {
    final response = await _getActiveGuestListUseCase.execute(
      listItemCount: listItemCount,
      cursor: null,
    );

    if (response is ApiSuccess) {
      final activeGuestCount = await _updateActiveGuestCount();
      final activeGuestResponse = response.value as ActiveGuestResponse;

      _appWaitingGuest.updateActiveGuestData(
        activeGuestList: activeGuestResponse.waitingGuestList,
        cursor: activeGuestResponse.cursor,
        activeGuestCount: activeGuestCount,
        hasActiveListNext: activeGuestResponse.hasNext,
        needNotify: true, // UI ì—…ë°ì´íŠ¸ íŠ¸ë¦¬ê±°
      );
    }
  }

  // ì·¨ì†Œ ì‹œ ê°œë³„ ê²ŒìŠ¤íŠ¸ ì •ë³´ë§Œ ì—…ë°ì´íŠ¸ (ìµœì í™”)
  Future<void> _updateCanceledCustomer({
    required Map<String, dynamic> params
  }) async {
    final Guest guest = Guest.fromJson(params);
    _appWaitingGuest.addCanceledGuest(canceledGuest: guest);
    await _updateActiveGuestCount();
  }
}
```

#### ê¸°ìˆ ì  ë„ì „ê³¼ í•´ê²°

**ë¬¸ì œ**: MQTT ì—°ê²° ë¶ˆì•ˆì •ìœ¼ë¡œ ì¸í•œ ë©”ì‹œì§€ ìœ ì‹¤
**í•´ê²°**:

- ì•± í¬ê·¸ë¼ìš´ë“œ ì „í™˜ ì‹œ ëª©ë¡ ì „ì²´ ìƒˆë¡œê³ ì¹¨
- ìë™ ì¬ì—°ê²° ë¡œì§ êµ¬í˜„

```dart
// lib/ui/views/main/main_screen.dart
@override
void didChangeAppLifecycleState(AppLifecycleState state) {
  if (state == AppLifecycleState.resumed) {
    // í¬ê·¸ë¼ìš´ë“œë¡œ ëŒì•„ì˜¬ ë•Œ ì „ì²´ ë°ì´í„° ìƒˆë¡œê³ ì¹¨
    _refreshAllData();
  }
}
```

### 3. OTA(Over-The-Air) ë¬´ì„  ì•± ì—…ë°ì´íŠ¸

#### í•µì‹¬ ê¸°ëŠ¥

- **ì„œë²„ ë²„ì „ ì²´í¬**: ì•± ì‹œì‘ ì‹œ ì„œë²„ì˜ ìµœì‹  ë²„ì „ í™•ì¸
- **ë¬´ì„  ë‹¤ìš´ë¡œë“œ ë° ì„¤ì¹˜**: APK íŒŒì¼ ë‹¤ìš´ë¡œë“œ ë° ìë™ ì„¤ì¹˜
- **ì§„í–‰ë¥  í‘œì‹œ**: ë‹¤ìš´ë¡œë“œ ì§„í–‰ ìƒí™© ì‹¤ì‹œê°„ í‘œì‹œ
- **ê¶Œí•œ ê´€ë¦¬**: ì„¤ì¹˜ ê¶Œí•œ ì—†ì„ ì‹œ ì‹œìŠ¤í…œ ì„¤ì •ìœ¼ë¡œ ì´ë™

#### êµ¬í˜„ ì„¸ë¶€ì‚¬í•­

```dart
// lib/services/app_update_service/app_update_service_impl.dart
class AppUpdateServiceImpl implements AppUpdateService {
  @override
  void updateAppViaOTA({
    required String appUrl,
    required AppUpdateStatusCallback callback,
  }) {
    try {
      OtaUpdate().execute(appUrl).listen(
        (OtaEvent event) {
          final OtaStatus status = event.status;

          switch (status) {
            case OtaStatus.DOWNLOADING:
              callback(OtaUpdateProgress(event.value ?? ''));
              break;

            case OtaStatus.INSTALLING:
              callback(OtaUpdateSuccess());
              break;

            case OtaStatus.PERMISSION_NOT_GRANTED_ERROR:
            case OtaStatus.DOWNLOAD_ERROR:
            case OtaStatus.INTERNAL_ERROR:
              callback(OtaUpdateFailure(event.status));
              break;
          }
        },
      );
    } catch (e, st) {
      callback(OtaUpdateFailure(e, st));
    }
  }
}

// lib/ui/views/startup/startup_view_model.dart
class StartupViewModel extends BaseViewModel {
  Future<void> checkAndUpdateApp() async {
    // 1. ì„œë²„ì—ì„œ ìµœì‹  ë²„ì „ ì •ë³´ ì¡°íšŒ
    final versionResult = await _getAppVersionUseCase.execute();

    if (versionResult is ApiSuccess) {
      final versionData = versionResult.value as AppVersionResponse;
      final currentVersion = await _packageInfo.version;

      // 2. ë²„ì „ ë¹„êµ
      if (_needsUpdate(currentVersion, versionData.version)) {
        _updateStatus = AppUpdateStatus.updateAvailable;
        notifyListeners();

        // 3. ì‚¬ìš©ì í™•ì¸ í›„ OTA ì—…ë°ì´íŠ¸ ì‹œì‘
        await _startOTAUpdate(versionData.downloadUrl);
      }
    }
  }

  Future<void> _startOTAUpdate(String downloadUrl) async {
    _appUpdateService.updateAppViaOTA(
      appUrl: downloadUrl,
      callback: (result) {
        if (result is OtaUpdateProgress) {
          _downloadProgress = double.parse(result.progress);
          _updateStatus = AppUpdateStatus.downloading;
          notifyListeners();
        } else if (result is OtaUpdateSuccess) {
          _updateStatus = AppUpdateStatus.installing;
          notifyListeners();
        } else if (result is OtaUpdateFailure) {
          _handleUpdateFailure(result);
        }
      },
    );
  }

  // ê¶Œí•œ ì—†ì„ ì‹œ ì‹œìŠ¤í…œ ì„¤ì •ìœ¼ë¡œ ì´ë™
  void _handlePermissionError() {
    showDialog(
      title: 'ì„¤ì¹˜ ê¶Œí•œ í•„ìš”',
      onConfirm: () => AppSettings.openAppSettings(),
    );
  }
}
```

#### ê¸°ìˆ ì  ë„ì „ê³¼ í•´ê²°

**ë¬¸ì œ**: Android 13+ ì—ì„œ ì•± ì„¤ì¹˜ ê¶Œí•œ íšë“ ì‹¤íŒ¨
**í•´ê²°**:

- `app_settings` íŒ¨í‚¤ì§€ë¥¼ ì‚¬ìš©í•´ ì‹œìŠ¤í…œ ì„¤ì •ìœ¼ë¡œ ì§ì ‘ ì´ë™
- ê¶Œí•œ ì²´í¬ í›„ ì„¤ì¹˜ ì§„í–‰

```dart
if (status == OtaStatus.PERMISSION_NOT_GRANTED_ERROR) {
  await AppSettings.openAppSettings(); // ì‹œìŠ¤í…œ ì„¤ì • ì—´ê¸°
}
```

### 4. Method Channelì„ í™œìš©í•œ Native í”Œë«í¼ ì—°ë™

#### í•µì‹¬ ê¸°ëŠ¥

- **ë””ë°”ì´ìŠ¤ ëª¨ë¸ ì¡°íšŒ**: ì•±ì´ íŠ¹ì • Monki ì „ìš© ë””ë°”ì´ìŠ¤ì—ì„œë§Œ ì‹¤í–‰ë˜ë„ë¡ ì œí•œ
- **Flutter-Native ë¸Œë¦¿ì§€**: Kotlin/Swiftì™€ Dart ê°„ í†µì‹ 

#### êµ¬í˜„ ì„¸ë¶€ì‚¬í•­

**Flutter ì¸¡ (Dart)**

```dart
// lib/services/system_service/platform_interface/method_channel_waiting.dart
class MethodChannelWaiting extends WaitingPlatform {
  final _methodChannel = const MethodChannel(
    'tableorder.waitlist.ceo.net/system',
  );

  @override
  Future<String?> getDeviceModel() {
    return _methodChannel.invokeMethod<String>('getDeviceModel');
  }
}

// lib/services/system_service/system_service_impl.dart
class SystemServiceImpl implements SystemService {
  final WaitingPlatform _platform;

  @override
  Future<String?> getDeviceModel() {
    return _platform.getDeviceModel();
  }
}
```

**Android ì¸¡ (Kotlin)**

```kotlin
// android/app/src/main/kotlin/.../MainActivity.kt
class MainActivity: FlutterActivity() {
    private val METHOD_CHANNEL = "tableorder.waitlist.ceo.net/system"

    override fun configureFlutterEngine(@NonNull flutterEngine: FlutterEngine) {
        super.configureFlutterEngine(flutterEngine)

        MethodChannel(
            flutterEngine.dartExecutor.binaryMessenger,
            METHOD_CHANNEL
        ).setMethodCallHandler { call, result ->
            when (call.method) {
                "getDeviceModel" -> {
                    val deviceModel = Build.MODEL
                    result.success(deviceModel)
                }
                else -> result.notImplemented()
            }
        }
    }
}
```

**ì‚¬ìš© ì˜ˆì‹œ**

```dart
// ì•± ì‹œì‘ ì‹œ ë””ë°”ì´ìŠ¤ ì²´í¬
class StartupViewModel extends BaseViewModel {
  Future<bool> _isMonkiDevice() async {
    final deviceModel = await _systemService.getDeviceModel();
    return deviceModel?.contains('T901') ?? false; // Monki ì „ìš© íƒœë¸”ë¦¿ ëª¨ë¸ëª…
  }

  Future<void> init() async {
    if (!await _isMonkiDevice()) {
      // ë¹„ì¸ê°€ ë””ë°”ì´ìŠ¤ì—ì„œëŠ” ì‹¤í–‰ ë¶ˆê°€
      _showUnauthorizedDeviceError();
      return;
    }
    // ì •ìƒ ì´ˆê¸°í™” ì§„í–‰
  }
}
```

#### ê¸°ìˆ ì  ë„ì „ê³¼ í•´ê²°

**ë¬¸ì œ**: iOSì™€ Android ê°„ í”Œë«í¼ ì¸í„°í˜ì´ìŠ¤ í†µì¼
**í•´ê²°**:

- `plugin_platform_interface` íŒ¨í‚¤ì§€ë¥¼ ì‚¬ìš©í•œ ì¶”ìƒí™”
- `WaitingPlatform` ì¶”ìƒ í´ë˜ìŠ¤ë¡œ ì¸í„°í˜ì´ìŠ¤ ì •ì˜
- `MethodChannelWaiting`ìœ¼ë¡œ êµ¬í˜„ì²´ ì œê³µ

### 5. ë°˜ì‘í˜• íƒœë¸”ë¦¿/ëª¨ë°”ì¼ UI

#### í•µì‹¬ ê¸°ëŠ¥

- **ë™ì  ë ˆì´ì•„ì›ƒ**: í™”ë©´ í¬ê¸°ì— ë”°ë¼ íƒœë¸”ë¦¿/ëª¨ë°”ì¼ ë ˆì´ì•„ì›ƒ ìë™ ì „í™˜
- **ScreenUtil ê¸°ë°˜**: ë””ìì¸ ì‚¬ì´ì¦ˆ ê¸°ì¤€ ë°˜ì‘í˜• í¬ê¸° ê³„ì‚°
- **SafeArea ì²˜ë¦¬**: ë…¸ì¹˜/í•˜ë‹¨ë°” ì˜ì—­ ì•ˆì „ ì²˜ë¦¬

#### êµ¬í˜„ ì„¸ë¶€ì‚¬í•­

```dart
// lib/main.dart
class _MyAppState extends State<MyApp> {
  @override
  Widget build(BuildContext context) {
    final isTablet = MediaQuery.of(context).size.width > mobileMaxWidth;
    final double screenSizeHeight = isTablet ? 800 : 812;
    final double screenSizeWidth = isTablet ? 1280 : 375;

    return ScreenUtilInit(
      designSize: Size(screenSizeWidth, screenSizeHeight),
      minTextAdapt: true,
      splitScreenMode: true,
      builder: (context, child) {
        return MaterialApp.router(...);
      },
    );
  }
}

// lib/ui/views/waiting_manage/waiting_manage_screen.dart
class WaitingManageScreen extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    final isTablet = context.screenWidth > mobileMaxWidth;

    return isTablet
        ? TabletWaitingLayout()  // íƒœë¸”ë¦¿ ë ˆì´ì•„ì›ƒ
        : MobileWaitingLayout(); // ëª¨ë°”ì¼ ë ˆì´ì•„ì›ƒ
  }
}
```

#### ë°˜ì‘í˜• í¬ê¸° ì ìš©

```dart
// ScreenUtilì„ í™œìš©í•œ ë°˜ì‘í˜• í¬ê¸°
Container(
  width: 200.w,   // í™”ë©´ ë„ˆë¹„ ë¹„ìœ¨ ê¸°ë°˜
  height: 100.h,  // í™”ë©´ ë†’ì´ ë¹„ìœ¨ ê¸°ë°˜
  padding: EdgeInsets.all(16.r), // ë°˜ì‘í˜• íŒ¨ë”©
  child: Text(
    'ëŒ€ê¸° ê´€ë¦¬',
    style: TextStyle(fontSize: 18.sp), // ë°˜ì‘í˜• í°íŠ¸ í¬ê¸°
  ),
)
```

### 6. ì²´ê³„ì ì¸ ì—ëŸ¬ í•¸ë“¤ë§

#### í•µì‹¬ ê¸°ëŠ¥

- **ApiResult íŒ¨í„´**: Success/Failure ë¶„ê¸° ì²˜ë¦¬
- **ì „ì—­ ì—ëŸ¬ ìƒíƒœ**: `AppApiError` ëª¨ë¸ì„ í†µí•œ ì—ëŸ¬ í† ìŠ¤íŠ¸ í‘œì‹œ
- **ì—ëŸ¬ ë³µêµ¬**: ìë™ ì¬ì‹œë„ ë° ì‚¬ìš©ì í”¼ë“œë°±

#### êµ¬í˜„ ì„¸ë¶€ì‚¬í•­

```dart
// lib/services/common/result/api_result.dart
sealed class ApiResult {}

class ApiSuccess extends ApiResult {
  final Object? value;
  ApiSuccess(this.value);
}

class ApiFailure extends ApiResult {
  final ApiError error;
  ApiFailure(this.error);
}

// ì‚¬ìš© ì˜ˆì‹œ
Future<void> loadData() async {
  final result = await _useCase.execute();

  switch (result) {
    case ApiSuccess(:final value):
      // ì„±ê³µ ì²˜ë¦¬
      _handleSuccess(value);
      break;

    case ApiFailure(:final error):
      // ì‹¤íŒ¨ ì²˜ë¦¬
      _appApiError.setOccurredApiError(
        isOccurredApiError: true,
        errorText: error.message,
      );
      break;
  }
}

// lib/models/app_api_error.dart
class AppApiError extends ChangeNotifier {
  bool _isOccurredApiError = false;
  String _errorText = '';

  void setOccurredApiError({
    required bool isOccurredApiError,
    required String errorText,
  }) {
    _isOccurredApiError = isOccurredApiError;
    _errorText = errorText;
    notifyListeners(); // ê¸€ë¡œë²Œ ì—ëŸ¬ í† ìŠ¤íŠ¸ íŠ¸ë¦¬ê±°
  }
}

// lib/ui/views/main/main_screen.dart
Consumer(
  builder: (context, ref, _) {
    ref.listen(appApiErrorProvider, (previous, next) {
      if (next.isOccurredApiError) {
        showToast(next.errorText); // ì—ëŸ¬ í† ìŠ¤íŠ¸ í‘œì‹œ
      }
    });
    return MainContent();
  },
)
```

---

## ğŸ”§ íŠ¸ëŸ¬ë¸”ìŠˆíŒ… ì‚¬ë¡€

### 1. MQTT ë©”ì‹œì§€ ìˆ˜ì‹  í›„ UI ì—…ë°ì´íŠ¸ ì§€ì—° ë¬¸ì œ

#### ë¬¸ì œ ìƒí™©

- MQTTë¡œ ëŒ€ê¸° ë“±ë¡ ì•Œë¦¼ ìˆ˜ì‹  í›„ í™”ë©´ì— ë°˜ì˜ë˜ëŠ”ë° 3~5ì´ˆ ì§€ì—° ë°œìƒ
- ì‚¬ìš©ìê°€ ìƒˆë¡œê³ ì¹¨ì„ ì—¬ëŸ¬ ë²ˆ ì‹œë„í•˜ëŠ” ë¶ˆí¸í•¨ ë°œìƒ

#### ì›ì¸ ë¶„ì„

```dart
// ë¬¸ì œ ì½”ë“œ
Future<void> _updateWaitCustomer() async {
  final response = await _getActiveGuestListUseCase.execute(...);
  _appWaitingGuest.updateActiveGuestData(...);
  // notifyListeners() í˜¸ì¶œ ì•ˆí•¨ - UI ì—…ë°ì´íŠ¸ ì•ˆë¨!
}
```

#### í•´ê²° ë°©ë²•

1. **ì„ íƒì  `notifyListeners()` í˜¸ì¶œ**: MQTT ìˆ˜ì‹  ì‹œì—ë§Œ UI ì—…ë°ì´íŠ¸

```dart
void updateActiveGuestData({
  required List<Guest> activeGuestList,
  bool needNotify = false, // í”Œë˜ê·¸ ì¶”ê°€
}) {
  _activeGuestList = activeGuestList;

  if (needNotify) {
    notifyListeners(); // UI ì—…ë°ì´íŠ¸ íŠ¸ë¦¬ê±°
  }
}

// MQTT í•¸ë“¤ëŸ¬ì—ì„œ needNotify: true ì „ë‹¬
_appWaitingGuest.updateActiveGuestData(
  activeGuestList: response.waitingGuestList,
  needNotify: true, // MQTT ìˆ˜ì‹  ì‹œì—ë§Œ ì•Œë¦¼
);
```

2. **AppLifecycle ì—°ë™**: ì•± í¬ê·¸ë¼ìš´ë“œ ì „í™˜ ì‹œ ê°•ì œ ìƒˆë¡œê³ ì¹¨

```dart
@override
void didChangeAppLifecycleState(AppLifecycleState state) {
  if (state == AppLifecycleState.resumed) {
    _waitingManageViewModel.loadActiveGuests(isRefresh: true);
  }
}
```

#### ê²°ê³¼

- MQTT ë©”ì‹œì§€ ìˆ˜ì‹  í›„ ì¦‰ì‹œ UI ë°˜ì˜ (0.5ì´ˆ ì´ë‚´)
- ì‚¬ìš©ì ë§Œì¡±ë„ í–¥ìƒ

---

### 2. Pagination ë¬´í•œ ìŠ¤í¬ë¡¤ ì¤‘ë³µ ë°ì´í„° ë¡œë”© ë¬¸ì œ

#### ë¬¸ì œ ìƒí™©

- ìŠ¤í¬ë¡¤ì„ ë¹ ë¥´ê²Œ ë‚´ë¦´ ë•Œ ë™ì¼í•œ ë°ì´í„°ê°€ ì¤‘ë³µìœ¼ë¡œ ë¡œë”©ë¨
- ì„œë²„ ë¶€í•˜ ë° ë¶ˆí•„ìš”í•œ ë„¤íŠ¸ì›Œí¬ ìš”ì²­ ë°œìƒ

#### ì›ì¸ ë¶„ì„

```dart
// ë¬¸ì œ ì½”ë“œ
Future<void> loadMore() async {
  // ë¡œë”© ì¤‘ ì²´í¬ ì—†ìŒ
  final result = await _useCase.execute(cursor: _cursor);
  _list.addAll(result.data); // ì¤‘ë³µ ì¶”ê°€ ê°€ëŠ¥
}
```

#### í•´ê²° ë°©ë²•

```dart
class WaitingManageViewModel extends BaseViewModel {
  bool _isLoadingMore = false; // ë¡œë”© ì¤‘ í”Œë˜ê·¸

  Future<void> loadMore() async {
    // 1. ì¤‘ë³µ ìš”ì²­ ë°©ì§€
    if (_isLoadingMore) return;
    if (!_appWaitingGuest.hasActiveListNext) return; // ë” ì´ìƒ ë°ì´í„° ì—†ìŒ

    _isLoadingMore = true;

    try {
      final cursor = _appWaitingGuest.activeGuestCursor;
      final result = await _getActiveGuestListUseCase.execute(
        listItemCount: listItemCount,
        cursor: cursor,
      );

      if (result is ApiSuccess) {
        final response = result.value as ActiveGuestResponse;

        // 2. ì¤‘ë³µ ë°ì´í„° í•„í„°ë§
        final newGuests = response.waitingGuestList
            .where((newGuest) => !_appWaitingGuest.activeGuestList
                .any((existing) => existing.id == newGuest.id))
            .toList();

        _appWaitingGuest.updateActiveGuestData(
          activeGuestList: newGuests,
          cursor: response.cursor,
          hasActiveListNext: response.hasNext,
        );
      }
    } finally {
      _isLoadingMore = false;
    }
  }
}
```

#### ê²°ê³¼

- ì¤‘ë³µ ë°ì´í„° ë¡œë”© ì™„ì „ ì œê±°
- ë„¤íŠ¸ì›Œí¬ ìš”ì²­ 50% ê°ì†Œ

---

### 3. OTA ì—…ë°ì´íŠ¸ ê¶Œí•œ íšë“ ì‹¤íŒ¨ (Android 13+)

#### ë¬¸ì œ ìƒí™©

- Android 13 ì´ìƒì—ì„œ OTA ì—…ë°ì´íŠ¸ ì‹œ ê¶Œí•œ ì—ëŸ¬ ë°œìƒ
- `PERMISSION_NOT_GRANTED_ERROR` ë°˜í™˜
- ì•± ì—…ë°ì´íŠ¸ ë¶ˆê°€

#### ì›ì¸ ë¶„ì„

- Android 13ë¶€í„° `REQUEST_INSTALL_PACKAGES` ê¶Œí•œì´ ëŸ°íƒ€ì„ ê¶Œí•œìœ¼ë¡œ ë³€ê²½
- ê¸°ì¡´ `ota_update` íŒ¨í‚¤ì§€ê°€ ìë™ìœ¼ë¡œ ê¶Œí•œ ìš”ì²­í•˜ì§€ ëª»í•¨

#### í•´ê²° ë°©ë²•

```dart
// lib/ui/views/startup/startup_view_model.dart
Future<void> _handleOTAUpdateFailure(OtaUpdateFailure failure) async {
  if (failure.error == OtaStatus.PERMISSION_NOT_GRANTED_ERROR) {
    // ê¶Œí•œ ì—†ì„ ì‹œ ì‚¬ìš©ìì—ê²Œ ì•ˆë‚´ í›„ ì‹œìŠ¤í…œ ì„¤ì • ì—´ê¸°
    final confirm = await showDialog(
      title: 'ì„¤ì¹˜ ê¶Œí•œ í•„ìš”',
      content: 'ì•± ì—…ë°ì´íŠ¸ë¥¼ ìœ„í•´ ì„¤ì¹˜ ê¶Œí•œì´ í•„ìš”í•©ë‹ˆë‹¤.\nì„¤ì •ìœ¼ë¡œ ì´ë™í•˜ì‹œê² ìŠµë‹ˆê¹Œ?',
      confirmText: 'ì„¤ì • ì—´ê¸°',
      cancelText: 'ì·¨ì†Œ',
    );

    if (confirm == true) {
      await AppSettings.openAppSettings(); // ì‹œìŠ¤í…œ ì„¤ì • ì—´ê¸°
    }
  }
}

// OTA ì—…ë°ì´íŠ¸ ì¬ì‹œë„ ë¡œì§
void retryUpdateWithPermission() {
  _appUpdateService.updateAppViaOTA(
    appUrl: _downloadUrl,
    callback: (result) {
      if (result is OtaUpdateFailure) {
        _handleOTAUpdateFailure(result);
      }
    },
  );
}
```

**AndroidManifest.xml ê¶Œí•œ ì¶”ê°€**

```xml
<uses-permission android:name="android.permission.REQUEST_INSTALL_PACKAGES"/>
```

#### ê²°ê³¼

- Android 13+ ì—ì„œ ì •ìƒì ìœ¼ë¡œ OTA ì—…ë°ì´íŠ¸ ê°€ëŠ¥
- ì‚¬ìš©ìê°€ ì„¤ì •ì—ì„œ ê¶Œí•œ í—ˆìš© í›„ ìë™ ì„¤ì¹˜ ì§„í–‰

---

### 4. Freezed ëª¨ë¸ JSON ì—­ì§ë ¬í™” ì—ëŸ¬

#### ë¬¸ì œ ìƒí™©

```
Error: type 'Null' is not a subtype of type 'int' in type cast
```

- ì„œë²„ì—ì„œ `null` ê°’ì„ ë³´ë‚¸ ê²½ìš° ì•± í¬ë˜ì‹œ ë°œìƒ
- API ì‘ë‹µì´ ì˜ˆìƒê³¼ ë‹¤ë¥¼ ë•Œ ì—ëŸ¬

#### ì›ì¸ ë¶„ì„

```dart
// ë¬¸ì œ ì½”ë“œ
@freezed
class ActiveCountResponse with _$ActiveCountResponse {
  factory ActiveCountResponse({
    required int count, // null ë¶ˆê°€
  }) = _ActiveCountResponse;

  factory ActiveCountResponse.fromJson(Map<String, dynamic> json) =>
      _$ActiveCountResponseFromJson(json);
}
```

#### í•´ê²° ë°©ë²•

```dart
// í•´ê²° ì½”ë“œ
@freezed
class ActiveCountResponse with _$ActiveCountResponse {
  factory ActiveCountResponse({
    @Default(0) int count, // ê¸°ë³¸ê°’ 0 ì„¤ì •
  }) = _ActiveCountResponse;

  factory ActiveCountResponse.fromJson(Map<String, dynamic> json) =>
      _$ActiveCountResponseFromJson(json);
}

// ë˜ëŠ” nullableë¡œ ì²˜ë¦¬
@freezed
class ActiveGuestResponse with _$ActiveGuestResponse {
  factory ActiveGuestResponse({
    required List<Guest> waitingGuestList,
    int? cursor, // nullable
    @Default(false) bool hasNext,
  }) = _ActiveGuestResponse;

  factory ActiveGuestResponse.fromJson(Map<String, dynamic> json) =>
      _$ActiveGuestResponseFromJson(json);
}
```

#### ê²°ê³¼

- JSON ì—­ì§ë ¬í™” ì—ëŸ¬ 0ê±´
- ì„œë²„ ì‘ë‹µ ë¶ˆì•ˆì • ìƒí™©ì—ì„œë„ ì•ˆì •ì  ë™ì‘

---

### 5. íƒœë¸”ë¦¿/ëª¨ë°”ì¼ ë°˜ì‘í˜• ë ˆì´ì•„ì›ƒ ê¹¨ì§ ë¬¸ì œ

#### ë¬¸ì œ ìƒí™©

- íŠ¹ì • í™”ë©´ í¬ê¸°ì—ì„œ UI ìš”ì†Œê°€ ê²¹ì¹˜ê±°ë‚˜ ì˜ë¦¼
- íƒœë¸”ë¦¿ íšŒì „ ì‹œ ë ˆì´ì•„ì›ƒ ë¶•ê´´

#### ì›ì¸ ë¶„ì„

```dart
// ë¬¸ì œ ì½”ë“œ
Container(
  width: 200, // ê³ ì • í¬ê¸° ì‚¬ìš©
  height: 100,
  child: Text('ëŒ€ê¸° ê´€ë¦¬', style: TextStyle(fontSize: 18)),
)
```

#### í•´ê²° ë°©ë²•

```dart
// í•´ê²° ì½”ë“œ
// 1. ScreenUtil ì ìš©
Container(
  width: 200.w,  // í™”ë©´ ë¹„ìœ¨ ê¸°ë°˜
  height: 100.h, // í™”ë©´ ë¹„ìœ¨ ê¸°ë°˜
  padding: EdgeInsets.all(16.r),
  child: Text(
    'ëŒ€ê¸° ê´€ë¦¬',
    style: TextStyle(fontSize: 18.sp), // ë°˜ì‘í˜• í°íŠ¸
  ),
)

// 2. MediaQuery ê¸°ë°˜ ë™ì  ë ˆì´ì•„ì›ƒ ì „í™˜
class WaitingManageScreen extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    final screenWidth = MediaQuery.of(context).size.width;
    final isTablet = screenWidth > 768;

    return isTablet
        ? TabletWaitingLayout()  // íƒœë¸”ë¦¿ ì „ìš© ë ˆì´ì•„ì›ƒ
        : MobileWaitingLayout(); // ëª¨ë°”ì¼ ì „ìš© ë ˆì´ì•„ì›ƒ
  }
}

// 3. Flexible/Expanded ì‚¬ìš©
Row(
  children: [
    Expanded(
      flex: 2,
      child: GuestList(),
    ),
    Expanded(
      flex: 1,
      child: StatusInfo(),
    ),
  ],
)
```

#### ê²°ê³¼

- ëª¨ë“  í™”ë©´ í¬ê¸°ì—ì„œ ì¼ê´€ëœ UI
- íƒœë¸”ë¦¿ ê°€ë¡œ/ì„¸ë¡œ íšŒì „ ì§€ì›

---

## ğŸ“Š í”„ë¡œì íŠ¸ ì„±ê³¼

### ì •ëŸ‰ì  ì„±ê³¼

- **ë²„ì „ ì—…ë°ì´íŠ¸**: 1.0.0 â†’ 1.0.7 (7ì°¨ ì—…ë°ì´íŠ¸)
- **PR ìˆ˜**: 79ê°œ ì´ìƒ
- **ì»¤ë°‹ ìˆ˜**: 200+ ì»¤ë°‹
- **ì½”ë“œ êµ¬ì¡°**: Clean Architecture ê¸°ë°˜ 3-layer êµ¬ì¡°
- **API ì—”ë“œí¬ì¸íŠ¸**: 15+ REST API ì—°ë™
- **MQTT í† í”½**: 3ê°œ ì‹¤ì‹œê°„ ì•Œë¦¼ ì²˜ë¦¬

### ê¸°ìˆ ì  ì„±ê³¼

- **Clean Architecture êµ¬í˜„**: Domain-Data-Presentation ì™„ì „ ë¶„ë¦¬
- **ì˜ì¡´ì„± ì£¼ì…**: GetItì„ í™œìš©í•œ DI ì»¨í…Œì´ë„ˆ êµ¬ì¶•
- **ì‹¤ì‹œê°„ í†µì‹ **: MQTT ê¸°ë°˜ ì–‘ë°©í–¥ ë©”ì‹œì§• êµ¬í˜„
- **OTA ì—…ë°ì´íŠ¸**: ë¬´ì„  ì•± ì—…ë°ì´íŠ¸ ì‹œìŠ¤í…œ êµ¬ì¶•
- **í”Œë«í¼ ì—°ë™**: Method Channelì„ í†µí•œ Flutter-Native ë¸Œë¦¿ì§€
- **ë°˜ì‘í˜• UI**: íƒœë¸”ë¦¿/ëª¨ë°”ì¼ ëŒ€ì‘ ì™„ë£Œ

### ì½”ë“œ í’ˆì§ˆ

- **íƒ€ì… ì•ˆì „ì„±**: Freezedë¥¼ í™œìš©í•œ ë¶ˆë³€ ëª¨ë¸
- **ì—ëŸ¬ í•¸ë“¤ë§**: ApiResult íŒ¨í„´ìœ¼ë¡œ ëª…í™•í•œ ì„±ê³µ/ì‹¤íŒ¨ ë¶„ê¸°
- **ë¡œê¹… ì‹œìŠ¤í…œ**: Logger íŒ¨í‚¤ì§€ ê¸°ë°˜ êµ¬ì¡°í™”ëœ ë¡œê·¸
- **ì½”ë“œ ìƒì„±**: Build Runnerë¡œ ë³´ì¼ëŸ¬í”Œë ˆì´íŠ¸ ìµœì†Œí™”

---

## ğŸ“ í•™ìŠµ ë° ì„±ì¥

### ê¸°ìˆ ì  í•™ìŠµ

1. **Flutter ì‹¬í™”**

   - Riverpodì„ í™œìš©í•œ ìƒíƒœ ê´€ë¦¬
   - ScreenUtil ê¸°ë°˜ ë°˜ì‘í˜• UI
   - Method Channel í”Œë«í¼ í†µì‹ 

2. **ì•„í‚¤í…ì²˜ ì„¤ê³„**

   - Clean Architecture ì‹¤ì „ ì ìš©
   - Repository Pattern êµ¬í˜„
   - Use Case ê¸°ë°˜ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ë¶„ë¦¬

3. **ì‹¤ì‹œê°„ í†µì‹ **

   - MQTT í”„ë¡œí† ì½œ ì´í•´ ë° êµ¬í˜„
   - ì–‘ë°©í–¥ ë©”ì‹œì§• ìµœì í™”

4. **Native ê°œë°œ**
   - Android (Kotlin) Method Channel êµ¬í˜„
   - iOS (Swift) í”Œë«í¼ ë¸Œë¦¿ì§€

### ë¬¸ì œ í•´ê²° ëŠ¥ë ¥

- ì‹¤ì‹œê°„ UI ì—…ë°ì´íŠ¸ ìµœì í™”
- Pagination ì¤‘ë³µ ë¡œë”© ë°©ì§€
- Android 13+ ê¶Œí•œ ì²˜ë¦¬
- JSON ì§ë ¬í™” ì•ˆì •ì„± í–¥ìƒ

### í˜‘ì—… ê²½í—˜

- Git Flow ê¸°ë°˜ ë¸Œëœì¹˜ ì „ëµ
- PR ê¸°ë°˜ ì½”ë“œ ë¦¬ë·° í”„ë¡œì„¸ìŠ¤
- ì»¨ë²¤ì…˜ ê¸°ë°˜ ì»¤ë°‹ ë©”ì‹œì§€ (feat/fix/refactor/docs)

---

## ğŸ”® í–¥í›„ ê°œì„  ë°©í–¥

### ê¸°ìˆ  ë¶€ì±„ í•´ê²°

- [ ] ìœ ë‹› í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ í™•ëŒ€
- [ ] Widget í…ŒìŠ¤íŠ¸ ì¶”ê°€
- [ ] í†µí•© í…ŒìŠ¤íŠ¸ êµ¬ì¶•

### ì„±ëŠ¥ ìµœì í™”

- [ ] ì´ë¯¸ì§€ ìºì‹± ì „ëµ ë„ì…
- [ ] ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ìµœì í™”
- [ ] ì•± ì‹œì‘ ì‹œê°„ ë‹¨ì¶•

### ê¸°ëŠ¥ ê°œì„ 

- [ ] ì˜¤í”„ë¼ì¸ ëª¨ë“œ ì§€ì›
- [ ] ëŒ€ê¸° í†µê³„ ëŒ€ì‹œë³´ë“œ
- [ ] í‘¸ì‹œ ì•Œë¦¼ ì¶”ê°€

### ê°œë°œ ê²½í—˜ ê°œì„ 

- [ ] CI/CD íŒŒì´í”„ë¼ì¸ êµ¬ì¶•
- [ ] ìë™ ë°°í¬ ì‹œìŠ¤í…œ
- [ ] ì—ëŸ¬ ëª¨ë‹ˆí„°ë§ (Sentry/Firebase Crashlytics)

---

## ğŸ“š ì°¸ê³  ìë£Œ

### í”„ë¡œì íŠ¸ ì •ë³´

- **Repository**: monthlykitchen/monki_waiting_ceo_app
- **Package**: net.monki.tableorder.waitlist.ceo
- **SDK**: Flutter 3.6.0+ / Dart 3.6.0+

### ì£¼ìš” PR ëª©ë¡

- #79: WAIT-73 - ì‹œìŠ¤í…œ ì„¤ì • ì´ë™ ê¸°ëŠ¥
- #78: WAIT-71 - ì—…ë°ì´íŠ¸ UI ê°œì„ 
- #77: WAIT-69 - OTA ì—…ë°ì´íŠ¸ êµ¬í˜„
- #76: WAIT-66 - ë””ë°”ì´ìŠ¤ ë²„ì „ API
- #75: WAIT-61 - Monki ë””ë°”ì´ìŠ¤ ì²´í¬ ë¡œì§
- #74: WAIT-62 - ì´ˆê¸° ë°ì´í„° API ë¦¬íŒ©í† ë§

Overview

- ë§¤ì¥ ì „ìš© monki_ceo_appì€ Flutter ê¸°ë°˜ìœ¼ë¡œ ëŒ€ê¸° ê³ ê° í˜„í™©, ì„¤ì •, ê¸°ê¸° ì´ˆê¸°í™”ë¥¼ í•œ í™”ë©´ì—ì„œ ê´€ë¦¬í•˜ë„ë¡ ì„¤ê³„ë˜ì–´ ìˆìœ¼ë©° ìŠ¤íƒ€íŠ¸ì—… í”Œë¡œìš°ì— OTAÂ·í† í° ê²€ì¦ì„ ë¬¶ì–´ ê¸°
  ê¸° ë¶€íŒ… ì§í›„ ë°”ë¡œ ìš´ì˜ ê°€ëŠ¥í•œ ìƒíƒœë¥¼ ë³´ì¥í•œë‹¤ (lib/ui/views/startup/startup_screen.dart:1, lib/ui/views/startup/startup_view_model.dart:1).
- ë ˆì´ì–´ë“œë¥¼ ë¶„ë¦¬í•œ Clean Architecture(services â†’ repositories â†’ use cases â†’ view models) ë•ë¶„ì— ê¸°ëŠ¥ í™•ì¥ ì‹œ ì˜ì¡´ì„± ì£¼ì…ë§Œìœ¼ë¡œ ëª¨ë“ˆì„ êµì²´í•  ìˆ˜ ìˆë‹¤ (lib/di/
  configure_dependencies.dart:1).
- ë””ë°”ì´ìŠ¤ë³„ í™˜ê²½ ë³€ìˆ˜ì™€ í˜¸ìŠ¤íŠ¸ ì •ë³´ë¥¼ ë¹Œë“œ íƒ€ì„ í”Œë˜ê·¸ë¡œ ì£¼ì…í•´ ë™ì¼ ì½”ë“œë² ì´ìŠ¤ë¡œ dev/staging/prodë¥¼ ë½‘ì•„ë‚¸ë‹¤ (lib/utils/configurations.dart:1,
  configurations-\*.json:1).
- MQTT ì•Œë¦¼, REST API, ë¡œì»¬ Hive ì €ì¥ì†Œ, OTA ì—…ë°ì´íŠ¸ ë“± ì„œë¡œ ë‹¤ë¥¸ IO ì±„ë„ì„ ì•± ëª¨ë¸ ê³„ì¸µìœ¼ë¡œ í¡ìˆ˜í•´ UIëŠ” ìƒíƒœ ë³€í™”ë§Œ êµ¬ë…í•˜ë©´ ëœë‹¤ (lib/services/
  monki_mqtt_service/monki_mqtt_service_impl.dart:1, lib/services/database_service/database_service_impl.dart:1).

Tech Stack

- Flutter 3.6, Riverpod 2.6, go_router, get_it DI, Retrofit + Dio, Hive, mqtt_client, ota_update, app_settings ë“±ì„ ì¡°í•©í•´ ëª¨ë°”ì¼Â·í‚¤ì˜¤ìŠ¤í¬ ì–‘ìª½ ìš”êµ¬ë¥¼ ì¶©ì¡±í•œ
  ë‹¤ (pubspec.yaml:1).
- Retrofit API í´ë¼ì´ì–¸íŠ¸ëŠ” Freezed DTOì™€ ApiResult ë˜í¼ë¥¼ í†µí•´ ì„±ê³µ/ì‹¤íŒ¨ë¥¼ ê°•íƒ€ì…ìœ¼ë¡œ ë°˜í™˜í•˜ì—¬ ViewModelì—ì„œ ë¶„ê¸° ë¡œì§ì„ ë‹¨ìˆœí™”í•œë‹¤ (lib/services/
  monki_api_service/waiting_guest/client/waiting_guest_api_client.dart:1, lib/services/common/result/api_result.dart:1).
- Dio ì¸í„°ì…‰í„°ëŠ” 401 ì‘ë‹µ ì‹œ ìë™ìœ¼ë¡œ Refresh í† í°ì„ ê°±ì‹ í•˜ê³  ì‹¤íŒ¨í•˜ë©´ Hiveì— ì €ì¥ëœ ìê²© ì¦ëª…ì„ ì •ë¦¬í•˜ëŠ” ë³µêµ¬ ë£¨í‹´ì„ ë‚´ì¥í–ˆë‹¤ (lib/services/dio/dio.dart:1).
- MethodChannel + Kotlin ë¸Œë¦¬ì§€ë¡œ â€œMonki ì „ìš© ë””ë°”ì´ìŠ¤ì¸ì§€â€ íŒë³„í•˜ëŠ” ì‹œìŠ¤í…œ ì„œë¹„ìŠ¤ë¥¼ ë§Œë“¤ê³ , Flutter ìª½ì— ì¶”ìƒ ì¸í„°í˜ì´ìŠ¤ë¡œ ì£¼ì…í–ˆë‹¤ (android/app/src/main/kotlin/
  net/monki/tableorder/waitlist/ceo/MainActivity.kt:1, lib/services/system_service/platform_interface/method_channel_waiting.dart:1).

Key Features

- OTA ì—…ë°ì´íŠ¸ íŒŒì´í”„ë¼ì¸: ë²„ì „ API ì¡°íšŒ â†’ ì•± ë‚´ ë¹„êµ â†’ ë‹¤ìš´ë¡œë“œ ìƒíƒœ/í¼ì„¼íŠ¸ í‘œì‹œ â†’ ì„¤ì¹˜ê¹Œì§€ ì´ì–´ì§€ëŠ” í”Œë¡œìš°ë¥¼ StartupViewModelê³¼ AppUpdateServiceë¡œ ìº¡ìŠí™”
  í–ˆë‹¤ (lib/ui/views/startup/startup_view_model.dart:118, lib/services/app_update_service/app_update_service_impl.dart:1, lib/ui/views/startup/components/
  update_progress_bar.dart:1).
- ì—…ë°ì´íŠ¸ ì¤‘ ê¶Œí•œ ê±°ë¶€ ì‹œ ì‹œìŠ¤í…œ ì„¤ì •ìœ¼ë¡œ ì´ë™ì‹œí‚¤ê³  ë³µê·€ ì‹œ ìë™ìœ¼ë¡œ ì„¤ì¹˜ë¥¼ ì¬ê°œí•˜ë„ë¡ ë¼ì´í”„ì‚¬ì´í´ì„ ì œì–´í•œë‹¤ (lib/ui/views/startup/startup_screen.dart:1).
- Waiting Manage ë·°ëª¨ë¸ì€ Riverpod ChangeNotifierì™€ AppTimerë¥¼ ì‚¬ìš©í•´ ì‹¤ì‹œê°„ ëŒ€ê¸° í˜„í™©, ìƒíƒœ ë³€ê²½, ë¹„í™œì„± ë¦¬ìŠ¤íŠ¸ í˜ì´ì§€ë„¤ì´ì…˜ì„ ì²˜ë¦¬í•œë‹¤ (lib/ui/views/
  waiting_manage/waiting_manage_view_model.dart:1, lib/models/app_timer.dart:1).
- Waiting Setting í™”ë©´ì€ API í˜¸ì¶œê³¼ Hive ìºì‹œë¥¼ ë™ì‹œì— ê°±ì‹ í•´ ë§¤ì¥ ìš´ì˜ ì •ì±…(ìë™ ì·¨ì†Œ, ì˜ˆìƒ ëŒ€ê¸° ì‹œê°„, ëŒ€ê¸°íŒ€ ì…ë ¥ ë°©ì‹)ì„ ì›ê²© ì œì–´í•œë‹¤ (lib/ui/views/
  waiting_setting/waiting_setting_view_model.dart:1, lib/services/database_service/database_service_impl.dart:1).
- MQTT ì„œë¹„ìŠ¤ëŠ” ë””ë°”ì´ìŠ¤ UDID ê¸°ë°˜ìœ¼ë¡œ í† í”½ì„ êµ¬ë…í•˜ê³  ëŠê¹€ì„ ê°ì§€í•´ ìë™ ì¬ì—°ê²°Â·ì¬êµ¬ë…ì„ ìˆ˜í–‰, ì•Œë¦¼ ë©”ì‹œì§€ë¥¼ Handlerì— ì „ë‹¬í•œë‹¤ (lib/services/monki_mqtt_service/
  monki_mqtt_service_impl.dart:1).

Troubleshooting / PR Stories

- WAIT-69 (#77, commits 054036eâ†’397e99b): ì•ˆë“œë¡œì´ë“œ 13+ì—ì„œ íŒŒì¼ ì ‘ê·¼ ê¶Œí•œì´ ë§‰í˜€ OTAê°€ ì‹¤íŒ¨í•˜ë˜ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ota_updateì™€ SAF filepathsë¥¼ ì¶”ê°€í•˜ê³ , ë‹¤ìš´
  ë¡œë“œÂ·ì„¤ì¹˜ ìƒíƒœë¥¼ UIì— ë…¸ì¶œí–ˆë‹¤ (lib/services/app_update_service/app_update_service_impl.dart:1, lib/ui/views/startup/startup_view_model.dart:118).
- WAIT-71 (#78): ì—…ë°ì´íŠ¸ ì§„í–‰ ìƒí™©ì´ ë¶ˆëª…í™•í•˜ë‹¤ëŠ” ìš´ì˜ í”¼ë“œë°±ì„ ë°›ì•„ íƒ€ë¸”ë ›/ëª¨ë°”ì¼ ëª¨ë‘ì—ì„œ ê°€ë…ì„± ë†’ì€ ì§„í–‰ UIë¥¼ ìƒˆë¡œ ì •ì˜í–ˆë‹¤ (lib/ui/views/startup/components/
  update_progress_bar.dart:1, lib/resources/app_colors.dart:1).
- WAIT-73 (#79, commit a8dd98e): ê¶Œí•œ ê±°ë¶€ ì‹œ ì‚¬ìš©ìê°€ ì„¤ì • ì•±ìœ¼ë¡œ ë‚˜ê°”ë‹¤ ëŒì•„ì˜¤ë©´ ì„¤ì¹˜ê°€ ë©ˆì¶”ëŠ” ë²„ê·¸ë¥¼ ê°ì§€í•˜ê³  AppSettings í”ŒëŸ¬ê·¸ì¸ + AppLifecycleStateë¥¼ ì´ìš©í•´
  ë³µê·€ ì‹œ checkAppUpdate()ë¥¼ ì¬í˜¸ì¶œí•˜ë„ë¡ í–ˆë‹¤ (lib/ui/views/startup/startup_screen.dart:24).
- WAIT-66 (#76): ë°±ì—”ë“œì—ì„œ ë°°í¬ ì¤‘ì¸ ê¸°ê¸°ë³„ ìµœì‹  ë¹Œë“œ ë²„ì „ì„ ë‚´ë ¤ì£¼ëŠ” APIë¥¼ ë¶™ì´ê³ , ë²„ì „ ë¹„êµÂ·ë‹¤ìš´ë¡œë“œ URL ë³´ê´€ì„ UseCase/Repository ë ˆì´ì–´ë¡œ ì˜¬ë ¸ë‹¤ (lib/domain/
  use_cases/app_version/get_app_version_use_case.dart:1, lib/data/repositories/app_version/app_version_repository_impl.dart:1).
- WAIT-61 (#75): ë¹„ì¸ê°€ ë””ë°”ì´ìŠ¤ê°€ ë§¤ì¥ ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸í•˜ëŠ” ê²ƒì„ ë§‰ê¸° ìœ„í•´ Kotlin MethodChannelì„ ì¶”ê°€í•˜ê³  Flutter ì¸¡ SystemServiceì—ì„œ ê¸°ê¸° ëª¨ë¸ëª…ì„ ê²€ì¦í•˜ëŠ” ë¡œ
  ì§ì„ ì‘ì„±í–ˆë‹¤ (android/app/src/main/kotlin/net/monki/tableorder/waitlist/ceo/MainActivity.kt:1, lib/services/system_service/system_service_impl.dart:1).

Portfolio Angles

- â€œOTAì™€ ê¶Œí•œ ì´ìŠˆê¹Œì§€ í¬í•¨í•œ í‚¤ì˜¤ìŠ¤í¬ ë¬´ì¤‘ë‹¨ ì—…ë°ì´íŠ¸ íŒŒì´í”„ë¼ì¸â€ ì‚¬ë¡€ë¡œ WAIT-69/71/73 ë¬¶ìŒì„ ì†Œê°œí•˜ë©´ ìš´ì˜ ì•ˆì •ì„±ì— ê¸°ì—¬í•œ ìŠ¤í† ë¦¬ë¥¼ ê°•ì¡°í•  ìˆ˜ ìˆë‹¤.
- â€œë©€í‹° ì±„ë„(REST + MQTT + ë¡œì»¬ Hive)ì„ í†µí•© ê´€ë¦¬í•˜ëŠ” Clean Architectureâ€ë¥¼ ë³´ì—¬ì£¼ë©° ëŒ€ê·œëª¨ ìƒíƒœ ê´€ë¦¬ ê²½í—˜ì„ ì–´í•„í•˜ì (lib/di/configure_dependencies.dart:1, lib/
  services/monki_mqtt_service/monki_mqtt_service_impl.dart:1).
- â€œë³´ì•ˆÂ·ì‹ ë¢°ì„± ê°•í™”ë¥¼ ìœ„í•œ í† í° ìë™ ë³µêµ¬ì™€ ë””ë°”ì´ìŠ¤ í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸â€ë¥¼ ë³„ë„ ì„¹ì…˜ìœ¼ë¡œ ì •ë¦¬í•˜ë©´ ì¸ì¦/ë³´ì•ˆ ê°ê°ì„ ë“œëŸ¬ë‚¼ ìˆ˜ ìˆë‹¤ (lib/services/dio/dio.dart:1, lib/
  services/system_service/platform_interface/method_channel_waiting.dart:1).
- â€œë§¤ì¥ ìš´ì˜ì§€í‘œ UI/UX ê°œì„ â€ ê´€ì ì—ì„œ ëŒ€ê¸° ê´€ë¦¬Â·ì„¤ì • ë·°ëª¨ë¸ê³¼ ì»¤ìŠ¤í…€ ìœ„ì ¯(Progress Bar, Dialog ë“±)ì„ ë¬¶ì–´ ì„¤ëª…í•˜ë©´ ì‚¬ìš©ì ê²½í—˜ ê°œì„  ëŠ¥ë ¥ì„ ë³´ì—¬ì¤„ ìˆ˜ ìˆë‹¤ (lib/ui/
  views/waiting_manage/waiting_manage_view_model.dart:1, lib/ui/views/startup/components/update_progress_bar.dart:1).
